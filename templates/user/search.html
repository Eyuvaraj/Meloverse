{% extends "user/user_dashboard.html" %}

{% block body %}
<div class="container">
    <div class="card border-dark mb-3 mt-3">
        <div>
            {% if not creators and not albums and not tracks and not genre %}
            <h3>No result found for "{{query}}" :(</h3>
            <pre class="text-end">
                        ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣠⣠⣀⢤⣖⣲⣦⣄⠀⠀⢀⡠⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
                        ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢀⢤⣤⣄⠻⡽⣺⣭⣿⡽⣾⣭⢿⣷⣉⠂⣿⠤⣄⣀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
                        ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣼⢿⣭⣏⣿⣷⣿⣿⣿⣽⣳⣾⣯⣿⣿⣏⣯⡴⣏⡆⢠⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
                        ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢠⣝⣯⢞⣿⡿⢿⠻⠛⡭⢛⠳⢋⠝⡩⢟⠻⣿⣟⣿⡿⣜⡍⡶⡀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
                        ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢀⣾⣿⣿⡏⠧⡙⠌⡡⠡⠐⡈⠄⡁⢂⠐⡈⡑⠢⣍⠻⣿⣿⣞⡷⣽⠂⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
                        ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢰⣾⣿⢞⡷⡈⢆⠑⡈⠄⡁⢂⠐⠠⠐⢀⠂⠡⣈⠱⢠⠓⡜⣿⣺⣽⣿⣳⠆⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
                        ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢘⣿⣿⣟⠦⡑⢂⠡⠌⡐⢀⠂⠌⠐⢈⠠⠈⠔⡠⢑⢢⠩⡜⣱⣿⣿⣯⠑⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
                        ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢸⣿⣿⢏⠢⡑⣌⠶⣱⣎⢦⠘⠠⢈⠀⠄⡱⣸⢴⣣⣌⡒⢡⢛⣾⣿⡧⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
                        ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢸⣷⣿⠂⡱⢰⠉⡎⡤⣌⢆⣫⡑⢂⠸⣰⠱⢍⠛⡉⠯⣝⢢⢉⣾⣟⣿⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
                        ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢘⣳⢯⠐⡡⠊⡝⢋⠄⢓⠛⠤⡑⢂⠰⣍⠚⡀⢛⡾⢷⣌⠣⢢⢽⣿⠏⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
                        ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠠⠘⣯⠂⠅⠂⠌⠠⠈⠠⠈⠔⡀⠂⠰⠌⡑⠠⠒⠘⢂⠌⡂⢇⣾⣟⠣⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
                        ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠠⢁⠏⡘⢌⠰⢀⠂⠌⠄⡙⠲⢄⢣⠼⡴⣈⠆⠈⡐⠀⢆⠱⡌⢾⢡⠃⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
                        ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢌⠢⢍⠢⡑⢢⠙⡈⠔⣈⠅⢂⢂⠘⡄⢣⡘⠤⡐⡉⢆⠳⡘⢬⢃⠆⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
                        ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠠⢈⠒⡌⠤⠑⡀⢓⠚⠫⢌⡘⠂⠚⠘⡘⢦⣕⢢⠡⡙⣌⠣⡝⢢⠍⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
                        ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠘⡤⢃⠜⡠⢂⠌⡑⠢⢐⠃⡚⠴⢩⠖⡌⠢⡐⡱⢠⠓⣜⠣⠎⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
                        ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠱⣩⢒⡱⢌⠢⢄⡁⢂⠐⡠⢃⠢⡘⢄⠣⣜⡡⢇⡻⣌⠓⠈⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
                        ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢡⢏⡜⣎⠳⣦⢜⡤⢣⢔⣢⠱⣍⣮⢳⡼⣹⣏⢷⣹⡆⢀⠀⠀⠀⠀⠀⠀⠀⠈⠀⡀⠀⠀⠀⠀⠀⠀⠀⠀
                        ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢀⣾⠸⡜⣬⢓⣮⣙⣞⢻⡞⣳⣟⡿⣞⣯⣟⡷⣫⡞⣽⢻⣿⡖⢢⠁⠀⠀⠈⠀⠀⠀⠐⠀⠀⠀⠀⠀⠀⠀⠀
                        ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢀⢠⠢⡝⣼⡡⢛⡴⣋⠶⣩⢎⡷⣝⡳⢾⣝⡻⣼⢎⠗⡣⡝⢆⣏⠲⣁⠃⡙⢆⠦⣀⢁⠀⠀⠂⠀⠀⠀⠀⠀⠀⠀⠀
                        ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢀⠰⣈⠖⡱⢘⡼⡇⡅⢒⢩⢒⢡⠚⡴⢡⢋⠳⢎⡹⢐⠊⣬⠱⣉⠆⣇⠢⡅⢊⠔⣈⠒⢥⢪⠱⡀⠀⠀⠀⠀⠀⠀⠀⠀⠀
                        ⠀⠀⠀⠀⠀⠀⠀⢀⢀⠠⢄⠢⡘⢄⠣⢎⡱⢌⠢⡑⡚⡵⡘⢌⠢⠎⡄⢣⠐⢣⢈⡑⢢⠐⡡⢚⠄⡣⢄⢋⡶⢱⠈⢆⠊⠤⡉⢆⠢⠡⢘⠒⡄⡀⠀⠀⠀⠀⠀⠀
                        ⠀⠀⠀⣀⠠⡐⢌⠲⣈⠒⡌⢢⠑⡌⡚⢄⠒⡌⠰⢡⠘⡥⣙⠢⡑⢊⠜⢢⠙⡄⠢⢘⠠⡑⡴⢋⠰⡁⢎⡰⣩⠃⡜⢌⡘⠤⡑⡌⠰⡁⢆⠡⢂⠱⡀⠄⡀⠀⠀⠀
                        ⠀⢀⠳⣌⢒⠡⢊⠴⣀⠣⡘⢄⠣⣘⢡⠊⠴⣈⠑⢢⠑⡸⢀⠣⡑⠌⡘⠄⠃⡄⠃⡌⢢⡑⢦⠉⣆⠑⣎⣱⠆⡱⢈⠖⡨⢰⠡⢌⡑⠨⢄⠃⡌⠴⡑⢎⡔⢆⡀⠀
                        ⢀⢎⡱⢈⠆⡱⢈⡒⠤⡡⡑⢌⠢⡅⢛⡬⠱⢠⠉⢆⠱⡈⢇⠠⠐⡈⠐⡈⠔⠠⠑⢠⠣⡜⢢⠑⡌⢾⡛⡍⢢⠑⡊⡔⢡⢣⠘⠤⡘⠰⢈⠢⣉⡴⡱⢎⡜⢢⡕⠀
                                    </pre>
            {% else %}
            <h4>SEARCH RESULTS FOR "{{query}}"</h4>
            <hr>
            {% endif %}
        </div>
        <div class="card-body">
            {% if genre %}
            <h5 class="card-title">{{query.upper()}} SONGS</h5>
            <div class="row">
                {% for track, creator, album in genre %}

                <div class="col-4">
                    <div class="card mb-1 mt-1">
                        <div class="card-header">
                            <a href="{{ url_for('user.creator_profile', user=current_user, creator=creator.creator_id) }}"
                                style="text-decoration: none;">
                                {{ creator.creator_name }}
                            </a>
                        </div>
                        <div class="card-body stretched-link" data-track-id="{{ track.track_id }}"
                            data-track-file="{{ track.track_file }}" data-track-name="{{ track.track_name }}"
                            data-artists="{{ track.artists }}" data-creatorid="{{ creator.creator_id }}"
                            data-creator="{{ creator.creator_name }}" data-lyrics="{{ track.lyrics }}"
                            data-current-user-name="{{ current_user.username }}" data-plays="{{ track.plays }}"
                            data-dislikes="{{ track.dislikes }}" data-likes="{{ track.likes }}"
                            data-current-user-id="{{ current_user.id }}" style="position: relative;">
                            <h5 class="card-title">{{ track.track_name }}{% if track.album_id != 0 %} (album:
                                {{album.album_name}}) {% endif %}</h5>
                        </div>
                    </div>
                </div>
                {% endfor %}
            </div>
            {% else %}
            {% if creators %}
            <h5 class="card-title">CREATORS</h5>
            <div class="row">
                {% for creator in creators %}
                <div class="col-4">
                    <div class="card mb-2 mt-1">
                        <a href="{{ url_for('user.creator_profile', user=current_user, creator=creator.creator_id) }}"
                            style="text-decoration: none;">
                            <div class="card-header">{{ creator.creator_name }}</div>
                        </a>
                        <div class="card-body">
                            {{ creator.bio }}
                        </div>
                    </div>
                </div>
                {% endfor %}
            </div>
            <br>
            {% endif %}


            {% if albums %}
            <h5 class="card-title">ALBUMS</h5>
            <div class="row">
                {% for album, tracks, creator in albums %}
                {% if loop.changed(album.album_id) %}
                <div class="col-4">
                    <div class="card mb-2 mt-1">
                        <a href="{{ url_for('user.creator_profile', user=current_user, creator=creator.creator_id) }}"
                            style="text-decoration: none;">
                            <div class="card-header">{{ album.album_name }} - {{ creator.creator_name }}</div>
                        </a>
                        <div class="card-body">
                            <div class="btn-group" role="group">
                                {% if album.album_id not in liked_albums %}
                                <button type="button" class="btn btn-dark btn-sm Albumlike"
                                    data-album-id="{{ album.album_id }}"><span
                                        class="bi bi-hand-thumbs-up"></span></button>
                                {% else %}
                                <button type="button" class="btn btn-light btn-sm Albumlike"
                                    data-album-id="{{ album.album_id }}"><span
                                        class="bi bi-hand-thumbs-up"></span></button>
                                {% endif %}
                                <div class="btn-group" role="group">
                                    <button type="button" class="btn btn-dark btn-sm dropdown-toggle"
                                        data-bs-toggle="dropdown">
                                        Tracks
                                    </button>
                                    <ul class="dropdown-menu track-dropdown">
                                        {% for album_, track, creator_ in albums %}
                                        <li>
                                            <a class="dropdown-item" href="#" data-track-id="{{ track.track_id }}"
                                                data-track-name="{{ track.track_name }}"
                                                data-artists="{{ track.artists }}"
                                                data-creator-id="{{ track.creator_id }}"
                                                data-creator="{{ creator.creator_name }}"
                                                data-trackId="{{ track.track_id }}"
                                                data-current-user-name="{{ current_user.username }}"
                                                data-lyrics="{{ track.lyrics }}"
                                                data-current-user-id="{{ current_user.id }}"
                                                data-track-file="{{ track.track_file }}" data-plays="{{ track.plays }}"
                                                data-dislikes="{{ track.dislikes }}" data-likes="{{ track.likes }}">
                                                {{ track.track_name }}
                                            </a>
                                        </li>
                                        {% endfor %}
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                {% endif %}
                {% endfor %}
            </div>
            <br>
            {% endif %}

            {% if tracks %}
            <h5 class="card-title">SONGS</h5>
            <div class="row">
                {% for track, creator, album in tracks %}

                <div class="col-4">
                    <div class="card mb-1 mt-1">
                        <a href="{{ url_for('user.creator_profile', user=current_user, creator=creator.creator_id) }}"
                            style="text-decoration: none;">
                            <div class="card-header">{{ creator.creator_name }}</div>
                        </a>
                        <div class="card-body stretched-link" data-track-id="{{ track.track_id }}"
                            data-track-file="{{ track.track_file }}" data-track-name="{{ track.track_name }}"
                            data-artists="{{ track.artists }}" data-creatorid="{{ creator.creator_id }}"
                            data-creator="{{ creator.creator_name }}"
                            data-current-user-name="{{ current_user.username }}" data-lyrics="{{ track.lyrics }}"
                            data-current-user-id="{{ current_user.id }}" data-plays="{{ track.plays }}"
                            data-dislikes="{{ track.dislikes }}" data-likes="{{ track.likes }}">
                            <h5 class="card-title">{{ track.track_name }} {% if track.album_id != 0 %} (album: {{
                                album.album_name }}) {% endif %} </h5>
                        </div>
                    </div>
                </div>
                {% endfor %}
            </div>
            {% endif %}
            {% endif %}
        </div>
    </div>
</div>

{% endblock %}